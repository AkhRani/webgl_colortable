<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Web GL Color Lookup</title>
        <script src="coloradjuster.js"></script>
        <script>
          adjuster = new ColorAdjuster();

          function start() {
            var canvas = document.getElementById("glcanvas");
            adjuster.init(canvas);
            adjuster.setWindow(4096, 0);

            // This is the simulated image data.
            var data = new Uint16Array(4096);
            for (i = 0; i < 4096; i++) {
              data[i] = i;
            }
            adjuster.setImageData(data, 64, 64);
            adjuster.drawImage();

            document.getElementById("windowControl").
              addEventListener("input", onWindowChanged, false);
            document.getElementById("levelControl").
              addEventListener("input", onWindowChanged, false);
          }

          function onWindowChanged(evt) {
            var windowControl = document.getElementById("windowControl");
            var levelControl =  document.getElementById("levelControl");


            // Rescale window range from 256 to 4095
            var range = windowControl.value * 16;
            var level = levelControl.value / 256.0;
            var start = (4096 - range) * level;

            adjuster.setWindow(range, start);
            adjuster.drawImage();
          }

        </script>
    </head>

    <body onload="start()">
      <canvas id="glcanvas" width="256" height="256">
      Missing canvas support
      </canvas>
      </br>
      <input id="windowControl" type="range" min="16" max="256" value="256" >Window</input></br>
      <input id="levelControl" type="range" min="0" max="255" value="128" >Level</input></br>
    </body>

</html>

